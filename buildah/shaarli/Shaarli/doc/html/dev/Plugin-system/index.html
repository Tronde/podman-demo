<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">



    <title>Plugin System - Shaarli Documentation</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Plugin System";
        var mkdocs_page_input_path = "dev/Plugin-system.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Shaarli Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Setup</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Server-configuration/">Server configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Installation/">Installation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Docker/">Docker</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Reverse-proxy/">Reverse Proxy</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Backup-and-restore/">Backup and restore</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Shaarli-configuration/">Shaarli configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Plugins/">Plugins</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Upgrade-and-migration/">Upgrade and migration</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Usage</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Usage/">Usage</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../REST-API/">REST API</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Community-and-related-software/">Community and Related software</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Development</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../Development/">Development</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Versioning/">Versioning</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../GnuPG-signature/">GnuPG signature</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Plugin System</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#developer-api">Developer API</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#what-can-i-do-with-plugins">What can I do with plugins?</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#how-can-i-create-a-plugin-for-shaarli">How can I create a plugin for Shaarli?</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#plugin-initialization">Plugin initialization</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#understanding-hooks">Understanding hooks</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#plugins-data">Plugin's data</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#parameters">Parameters</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#special-data">Special data</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#filling-templates-placeholder">Filling templates placeholder</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#data-manipulation">Data manipulation</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#metadata">Metadata</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#register-plugins-routes">Register plugin's routes</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#understanding-relative-paths">Understanding relative paths</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#its-not-working">It's not working!</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#hooks">Hooks</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#render_header">render_header</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#render_includes">render_includes</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#render_footer">render_footer</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#render_linklist">render_linklist</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#render_editlink">render_editlink</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#render_tools">render_tools</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#render_picwall">render_picwall</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#render_tagcloud">render_tagcloud</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#render_taglist">render_taglist</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#render_daily">render_daily</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#render_feed">render_feed</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#save_link">save_link</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#delete_link">delete_link</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#save_plugin_parameters">save_plugin_parameters</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#filter_search_entry">filter_search_entry</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#guide-for-template-designers">Guide for template designers</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#plugin-administration">Plugin administration</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#placeholder-system">Placeholder system</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#list-of-placeholders">List of placeholders</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Translations/">Translations</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Release-Shaarli/">Release Shaarli</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Theming/">Theming</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Unit-tests/">Unit tests</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../Troubleshooting/">Troubleshooting</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Shaarli Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>Development &raquo;</li>
      <li>Plugin System</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/shaarli/Shaarli/edit/master/doc/md/dev/Plugin-system.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="plugin-system">Plugin system<a class="headerlink" href="#plugin-system" title="Permanent link">#</a></h1>
<h2 id="developer-api">Developer API<a class="headerlink" href="#developer-api" title="Permanent link">#</a></h2>
<h3 id="what-can-i-do-with-plugins">What can I do with plugins?<a class="headerlink" href="#what-can-i-do-with-plugins" title="Permanent link">#</a></h3>
<p>The plugin system lets you:</p>
<ul>
<li>insert content into specific places across templates.</li>
<li>alter data before templates rendering.</li>
<li>alter data before saving new links.</li>
</ul>
<h3 id="how-can-i-create-a-plugin-for-shaarli">How can I create a plugin for Shaarli?<a class="headerlink" href="#how-can-i-create-a-plugin-for-shaarli" title="Permanent link">#</a></h3>
<p>First, chose a plugin name, such as <code>demo_plugin</code>.</p>
<p>Under <code>plugin</code> folder, create a folder named with your plugin name. Then create a <plugin_name>.meta file and a <plugin_name>.php file in that folder.</p>
<p>You should have the following tree view:</p>
<pre><code>| index.php
| plugins/
|---| demo_plugin/
|   |---| demo_plugin.meta
|   |---| demo_plugin.php
</code></pre>
<h3 id="plugin-initialization">Plugin initialization<a class="headerlink" href="#plugin-initialization" title="Permanent link">#</a></h3>
<p>At the beginning of Shaarli execution, all enabled plugins are loaded. At this point, the plugin system looks for an <code>init()</code> function in the <plugin_name>.php to execute and run it if it exists. This function must be named this way, and takes the <code>ConfigManager</code> as parameter.</p>
<pre><code>&lt;plugin_name&gt;_init($conf)
</code></pre>
<p>This function can be used to create initial data, load default settings, etc. But also to set <em>plugin errors</em>. If the initialization function returns an array of strings, they will be understand as errors, and displayed in the header to logged in users.</p>
<p>The plugin system also looks for a <code>description</code> variable in the <plugin_name>.meta file, to be displayed in the plugin administration page.</p>
<pre><code>description="The plugin does this and that."
</code></pre>
<h3 id="understanding-hooks">Understanding hooks<a class="headerlink" href="#understanding-hooks" title="Permanent link">#</a></h3>
<p>A plugin is a set of functions. Each function will be triggered by the plugin system at certain point in Shaarli execution.</p>
<p>These functions need to be named with this pattern:</p>
<pre><code>hook_&lt;plugin_name&gt;_&lt;hook_name&gt;($data, $conf)
</code></pre>
<p>Parameters:</p>
<ul>
<li>data: see <a href="https://shaarli.readthedocs.io/en/master/Plugin-System/#plugins-data">$data section</a></li>
<li>conf: the <code>ConfigManager</code> instance.</li>
</ul>
<p>For example, if my plugin want to add data to the header, this function is needed:</p>
<pre><code>hook_demo_plugin_render_header
</code></pre>
<p>If this function is declared, and the plugin enabled, it will be called every time Shaarli is rendering the header.</p>
<h3 id="plugins-data">Plugin's data<a class="headerlink" href="#plugins-data" title="Permanent link">#</a></h3>
<h4 id="parameters">Parameters<a class="headerlink" href="#parameters" title="Permanent link">#</a></h4>
<p>Every hook function has a <code>$data</code> parameter. Its content differs for each hooks.</p>
<p><strong>This parameter needs to be returned every time</strong>, otherwise data is lost.</p>
<pre><code>return $data;
</code></pre>
<h4 id="special-data">Special data<a class="headerlink" href="#special-data" title="Permanent link">#</a></h4>
<p>Special additional data are passed to every hook through the
<code>$data</code> parameter to give you access to additional context, and services.</p>
<p>Complete list:</p>
<ul>
<li><code>_PAGE_</code> (string): if the current hook is used to render a template, its name is passed through this additional parameter.</li>
<li><code>_LOGGEDIN_</code> (bool): whether the user is logged in or not.</li>
<li><code>_BASE_PATH_</code> (string): if Shaarli instance is hosted under a subfolder, contains the subfolder path to <code>index.php</code> (e.g. <code>https://domain.tld/shaarli/</code> -&gt; <code>/shaarli/</code>).</li>
<li><code>_BOOKMARK_SERVICE_</code> (<code>BookmarkServiceInterface</code>): bookmark service instance, for advanced usage.</li>
</ul>
<p>Example:</p>
<pre><code class="language-php">if ($data['_PAGE_'] === TemplatePage::LINKLIST &amp;&amp; $data['LOGGEDIN'] === true) {
    // Do something for logged in users when the link list is rendered
}
</code></pre>
<h4 id="filling-templates-placeholder">Filling templates placeholder<a class="headerlink" href="#filling-templates-placeholder" title="Permanent link">#</a></h4>
<p>Template placeholders are displayed in template in specific places.</p>
<p>RainTPL displays every element contained in the placeholder's array. These element can be added by plugins.</p>
<p>For example, let's add a value in the placeholder <code>top_placeholder</code> which is displayed at the top of my page:</p>
<pre><code class="language-php">$data['top_placeholder'][] = 'My content';
# OR
array_push($data['top_placeholder'], 'My', 'content');

return $data;
</code></pre>
<h4 id="data-manipulation">Data manipulation<a class="headerlink" href="#data-manipulation" title="Permanent link">#</a></h4>
<p>When a page is displayed, every variable send to the template engine is passed to plugins before that in <code>$data</code>.</p>
<p>The data contained by this array can be altered before template rendering.</p>
<p>For example, in linklist, it is possible to alter every title:</p>
<pre><code class="language-php">// mind the reference if you want $data to be altered
foreach ($data['links'] as &amp;$value) {
    // String reverse every title.
    $value['title'] = strrev($value['title']);
}

return $data;
</code></pre>
<h3 id="metadata">Metadata<a class="headerlink" href="#metadata" title="Permanent link">#</a></h3>
<p>Every plugin needs a <code>&lt;plugin_name&gt;.meta</code> file, which is in fact an <code>.ini</code> file (<code>KEY="VALUE"</code>), to be listed in plugin administration.</p>
<p>Each file contain two keys:</p>
<ul>
<li><code>description</code>: plugin description</li>
<li><code>parameters</code>: user parameter names, separated by a <code>;</code>.</li>
<li><code>parameter.&lt;PARAMETER_NAME&gt;</code>: add a text description the specified parameter.</li>
</ul>
<blockquote>
<p>Note: In PHP, <code>parse_ini_file()</code> seems to want strings to be between by quotes <code>"</code> in the ini file.</p>
</blockquote>
<h3 id="register-plugins-routes">Register plugin's routes<a class="headerlink" href="#register-plugins-routes" title="Permanent link">#</a></h3>
<p>Shaarli lets you register custom Slim routes for your plugin.</p>
<p>To register a route, the plugin must include a function called <code>function &lt;plugin_name&gt;_register_routes(): array</code>.</p>
<p>This method must return an array of routes, each entry must contain the following keys:</p>
<ul>
<li><code>method</code>: HTTP method, <code>GET/POST/PUT/PATCH/DELETE</code></li>
<li><code>route</code> (path): without prefix, e.g. <code>/up/{variable}</code>
     It will be later prefixed by <code>/plugin/&lt;plugin name&gt;/</code>.</li>
<li><code>callable</code> string, function name or FQN class's method to execute, e.g. <code>demo_plugin_custom_controller</code>.</li>
</ul>
<p>Callable functions or methods must have <code>Slim\Http\Request</code> and <code>Slim\Http\Response</code> parameters
and return a <code>Slim\Http\Response</code>. We recommend creating a dedicated class and extend either
<code>ShaarliVisitorController</code> or <code>ShaarliAdminController</code> to use helper functions they provide.</p>
<p>A dedicated plugin template is available for rendering content: <code>pluginscontent.html</code> using <code>content</code> placeholder.</p>
<blockquote>
<p><strong>Warning</strong>: plugins are not able to use RainTPL template engine for their content due to technical restrictions.
RainTPL does not allow to register multiple template folders, so all HTML rendering must be done within plugin
custom controller.</p>
</blockquote>
<p>Check out the <code>demo_plugin</code> for a live example: <code>GET &lt;shaarli_url&gt;/plugin/demo_plugin/custom</code>.</p>
<h3 id="understanding-relative-paths">Understanding relative paths<a class="headerlink" href="#understanding-relative-paths" title="Permanent link">#</a></h3>
<p>Because Shaarli is a self-hosted tool, an instance can either be installed at the root directory, or under a subfolder.
This means that you can <em>never</em> use absolute paths (eg <code>/plugins/mything/file.png</code>).</p>
<p>If a file needs to be included in server end, use simple relative path:
<code>PluginManager::$PLUGINS_PATH . '/mything/template.html'</code>.</p>
<p>If it needs to be included in front end side (e.g. an image),
the relative path must be prefixed with special data:</p>
<ul>
<li>if it's a link that will need to be processed by Shaarli, use <code>_BASE_PATH_</code>:
    for e.g. <code>$data['_BASE_PATH_'] . '/admin/tools</code>.</li>
<li>if you want to include an asset, you need to add the root URL (base path without <code>/index.php</code>, for people using Shaarli without URL rewriting), then use <code>_ROOT_PATH_</code>:
    for e.g
<code>$['_ROOT_PATH_'] . '/' . PluginManager::$PLUGINS_PATH . '/mything/picture.png</code>.</li>
</ul>
<p>Note that special placeholders for CSS and JS files (respectively <code>css_files</code> and <code>js_files</code>) are already prefixed
with the root path in template files.</p>
<h3 id="its-not-working">It's not working!<a class="headerlink" href="#its-not-working" title="Permanent link">#</a></h3>
<p>Use <code>demo_plugin</code> as a functional example. It covers most of the plugin system features.</p>
<p>If it's still not working, please <a href="https://github.com/shaarli/Shaarli/issues/new">open an issue</a>.</p>
<h3 id="hooks">Hooks<a class="headerlink" href="#hooks" title="Permanent link">#</a></h3>
<table>
<thead>
<tr>
<th>Hooks</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#render_header">render_header</a></td>
<td align="center">Allow plugin to add content in page headers.</td>
</tr>
<tr>
<td><a href="#render_includes">render_includes</a></td>
<td align="center">Allow plugin to include their own CSS files.</td>
</tr>
<tr>
<td><a href="#render_footer">render_footer</a></td>
<td align="center">Allow plugin to add content in page footer and include their own JS files.</td>
</tr>
<tr>
<td><a href="#render_linklist">render_linklist</a></td>
<td align="center">It allows to add content at the begining and end of the page, after every link displayed and to alter link data.</td>
</tr>
<tr>
<td><a href="#render_editlink">render_editlink</a></td>
<td align="center">Allow to add fields in the form, or display elements.</td>
</tr>
<tr>
<td><a href="#render_tools">render_tools</a></td>
<td align="center">Allow to add content at the end of the page.</td>
</tr>
<tr>
<td><a href="#render_picwall">render_picwall</a></td>
<td align="center">Allow to add content at the top and bottom of the page.</td>
</tr>
<tr>
<td><a href="#render_tagcloud">render_tagcloud</a></td>
<td align="center">Allow to add content at the top and bottom of the page, and after all tags.</td>
</tr>
<tr>
<td><a href="#render_taglist">render_taglist</a></td>
<td align="center">Allow to add content at the top and bottom of the page, and after all tags.</td>
</tr>
<tr>
<td><a href="#render_daily">render_daily</a></td>
<td align="center">Allow to add content at the top and bottom of the page, the bottom of each link and to alter data.</td>
</tr>
<tr>
<td><a href="#render_feed">render_feed</a></td>
<td align="center">Allow to do add tags in RSS and ATOM feeds.</td>
</tr>
<tr>
<td><a href="#save_link">save_link</a></td>
<td align="center">Allow to alter the link being saved in the datastore.</td>
</tr>
<tr>
<td><a href="#delete_link">delete_link</a></td>
<td align="center">Allow to do an action before a link is deleted from the datastore.</td>
</tr>
<tr>
<td><a href="#save_plugin_parameters">save_plugin_parameters</a></td>
<td align="center">Allow to manipulate plugin parameters before they're saved.</td>
</tr>
<tr>
<td><a href="#filter_search_entry">filter_search_entry</a></td>
<td align="center">Add custom filters to Shaarli search engine</td>
</tr>
</tbody>
</table>
<h4 id="render_header">render_header<a class="headerlink" href="#render_header" title="Permanent link">#</a></h4>
<p>Triggered on every page - allows plugins to add content in page headers.</p>
<h5 id="data">Data<a class="headerlink" href="#data" title="Permanent link">#</a></h5>
<p><code>$data</code> is an array containing:</p>
<ul>
<li><a href="#special-data">Special data</a></li>
</ul>
<h5 id="template-placeholders">Template placeholders<a class="headerlink" href="#template-placeholders" title="Permanent link">#</a></h5>
<p>Items can be displayed in templates by adding an entry in <code>$data['&lt;placeholder&gt;']</code> array.</p>
<p>List of placeholders:</p>
<ul>
<li><code>buttons_toolbar</code>: after the list of buttons in the header.</li>
</ul>
<p><img alt="buttons_toolbar_example" src="http://i.imgur.com/ssJUOrt.png" /></p>
<ul>
<li><code>fields_toolbar</code>: after search fields in the header.</li>
</ul>
<blockquote>
<p>Note: This will only be called in linklist.</p>
</blockquote>
<p><img alt="fields_toolbar_example" src="http://i.imgur.com/3GMifI2.png" /></p>
<h4 id="render_includes">render_includes<a class="headerlink" href="#render_includes" title="Permanent link">#</a></h4>
<p>Triggered on every page - allows plugins to include their own CSS files.</p>
<h5 id="data_1">data<a class="headerlink" href="#data_1" title="Permanent link">#</a></h5>
<p><code>$data</code> is an array containing:</p>
<ul>
<li><a href="#special-data">Special data</a></li>
</ul>
<h5 id="template-placeholders_1">Template placeholders<a class="headerlink" href="#template-placeholders_1" title="Permanent link">#</a></h5>
<p>Items can be displayed in templates by adding an entry in <code>$data['&lt;placeholder&gt;']</code> array.</p>
<p>List of placeholders:</p>
<ul>
<li><code>css_files</code>: called after loading default CSS.</li>
</ul>
<blockquote>
<p>Note: only add the path of the CSS file. E.g: <code>plugins/demo_plugin/custom_demo.css</code>.</p>
</blockquote>
<h4 id="render_footer">render_footer<a class="headerlink" href="#render_footer" title="Permanent link">#</a></h4>
<p>Triggered on every page.</p>
<p>Allow plugin to add content in page footer and include their own JS files.</p>
<h5 id="data_2">data<a class="headerlink" href="#data_2" title="Permanent link">#</a></h5>
<p><code>$data</code> is an array containing:</p>
<ul>
<li><a href="#special-data">Special data</a></li>
</ul>
<h5 id="template-placeholders_2">Template placeholders<a class="headerlink" href="#template-placeholders_2" title="Permanent link">#</a></h5>
<p>Items can be displayed in templates by adding an entry in <code>$data['&lt;placeholder&gt;']</code> array.</p>
<p>List of placeholders:</p>
<ul>
<li><code>text</code>: called after the end of the footer text.</li>
<li><code>endofpage</code>: called at the end of the page.</li>
</ul>
<p><img alt="text_example" src="http://i.imgur.com/L5S2YEH.png" /></p>
<ul>
<li><code>js_files</code>: called at the end of the page, to include custom JS scripts.</li>
</ul>
<blockquote>
<p>Note: only add the path of the JS file. E.g: <code>plugins/demo_plugin/custom_demo.js</code>.</p>
</blockquote>
<h4 id="render_linklist">render_linklist<a class="headerlink" href="#render_linklist" title="Permanent link">#</a></h4>
<p>Triggered when <code>linklist</code> is displayed (list of links, permalink, search, tag filtered, etc.).</p>
<p>It allows to add content at the begining and end of the page, after every link displayed and to alter link data.</p>
<h5 id="data_3">data<a class="headerlink" href="#data_3" title="Permanent link">#</a></h5>
<p><code>$data</code> is an array containing:</p>
<ul>
<li>All templates data, including links.</li>
<li><a href="#special-data">Special data</a></li>
</ul>
<h5 id="template-placeholders_3">template placeholders<a class="headerlink" href="#template-placeholders_3" title="Permanent link">#</a></h5>
<p>Items can be displayed in templates by adding an entry in <code>$data['&lt;placeholder&gt;']</code> array.</p>
<p>List of placeholders:</p>
<ul>
<li><code>action_plugin</code>: next to the button "private only" at the top and bottom of the page.</li>
</ul>
<p><img alt="action_plugin_example" src="http://i.imgur.com/Q12PWg0.png" /></p>
<ul>
<li><code>link_plugin</code>: for every link, between permalink and link URL.</li>
</ul>
<p><img alt="link_plugin_example" src="http://i.imgur.com/3oDPhWx.png" /></p>
<ul>
<li><code>plugin_start_zone</code>: before displaying the template content.</li>
</ul>
<p><img alt="plugin_start_zone_example" src="http://i.imgur.com/OVBkGy3.png" /></p>
<ul>
<li><code>plugin_end_zone</code>: after displaying the template content.</li>
</ul>
<p><img alt="plugin_end_zone_example" src="http://i.imgur.com/6IoRuop.png" /></p>
<h4 id="render_editlink">render_editlink<a class="headerlink" href="#render_editlink" title="Permanent link">#</a></h4>
<p>Triggered when the link edition form is displayed.</p>
<p>Allow to add fields in the form, or display elements.</p>
<h5 id="data_4">data<a class="headerlink" href="#data_4" title="Permanent link">#</a></h5>
<p><code>$data</code> is an array containing:</p>
<ul>
<li>All templates data.</li>
<li><a href="#special-data">Special data</a></li>
</ul>
<h5 id="template-placeholders_4">template placeholders<a class="headerlink" href="#template-placeholders_4" title="Permanent link">#</a></h5>
<p>Items can be displayed in templates by adding an entry in <code>$data['&lt;placeholder&gt;']</code> array.</p>
<p>List of placeholders:</p>
<ul>
<li><code>edit_link_plugin</code>: after tags field.</li>
</ul>
<p><img alt="edit_link_plugin_example" src="http://i.imgur.com/5u17Ens.png" /></p>
<h4 id="render_tools">render_tools<a class="headerlink" href="#render_tools" title="Permanent link">#</a></h4>
<p>Triggered when the "tools" page is displayed.</p>
<p>Allow to add content at the end of the page.</p>
<h5 id="data_5">data<a class="headerlink" href="#data_5" title="Permanent link">#</a></h5>
<p><code>$data</code> is an array containing:</p>
<ul>
<li>All templates data.</li>
<li><a href="#special-data">Special data</a></li>
</ul>
<h5 id="template-placeholders_5">template placeholders<a class="headerlink" href="#template-placeholders_5" title="Permanent link">#</a></h5>
<p>Items can be displayed in templates by adding an entry in <code>$data['&lt;placeholder&gt;']</code> array.</p>
<p>List of placeholders:</p>
<ul>
<li><code>tools_plugin</code>: at the end of the page.</li>
</ul>
<p><img alt="tools_plugin_example" src="http://i.imgur.com/Bqhu9oQ.png" /></p>
<h4 id="render_picwall">render_picwall<a class="headerlink" href="#render_picwall" title="Permanent link">#</a></h4>
<p>Triggered when picwall is displayed.</p>
<p>Allow to add content at the top and bottom of the page.</p>
<h5 id="data_6">data<a class="headerlink" href="#data_6" title="Permanent link">#</a></h5>
<p><code>$data</code> is an array containing:</p>
<ul>
<li>All templates data.</li>
<li><a href="#special-data">Special data</a></li>
</ul>
<h5 id="template-placeholders_6">template placeholders<a class="headerlink" href="#template-placeholders_6" title="Permanent link">#</a></h5>
<p>Items can be displayed in templates by adding an entry in <code>$data['&lt;placeholder&gt;']</code> array.</p>
<p>List of placeholders:</p>
<ul>
<li><code>plugin_start_zone</code>: before displaying the template content.</li>
<li><code>plugin_end_zone</code>: after displaying the template content.</li>
</ul>
<p><img alt="plugin_start_end_zone_example" src="http://i.imgur.com/tVTQFER.png" /></p>
<h4 id="render_tagcloud">render_tagcloud<a class="headerlink" href="#render_tagcloud" title="Permanent link">#</a></h4>
<p>Triggered when tagcloud is displayed.</p>
<p>Allow to add content at the top and bottom of the page.</p>
<h5 id="data_7">data<a class="headerlink" href="#data_7" title="Permanent link">#</a></h5>
<p><code>$data</code> is an array containing:</p>
<ul>
<li>All templates data.</li>
<li><a href="#special-data">Special data</a></li>
</ul>
<h5 id="template-placeholders_7">Template placeholders<a class="headerlink" href="#template-placeholders_7" title="Permanent link">#</a></h5>
<p>Items can be displayed in templates by adding an entry in <code>$data['&lt;placeholder&gt;']</code> array.</p>
<p>List of placeholders:</p>
<ul>
<li><code>plugin_start_zone</code>: before displaying the template content.</li>
<li><code>plugin_end_zone</code>: after displaying the template content.</li>
</ul>
<p>For each tag, the following placeholder can be used:</p>
<ul>
<li><code>tag_plugin</code>: after each tag</li>
</ul>
<p><img alt="plugin_start_end_zone_example" src="http://i.imgur.com/vHmyT3a.png" /></p>
<h4 id="render_taglist">render_taglist<a class="headerlink" href="#render_taglist" title="Permanent link">#</a></h4>
<p>Triggered when taglist is displayed - allows to add content at the top and bottom of the page.</p>
<h5 id="data_8">data<a class="headerlink" href="#data_8" title="Permanent link">#</a></h5>
<p><code>$data</code> is an array containing:</p>
<ul>
<li>All templates data.</li>
<li><a href="#special-data">Special data</a></li>
</ul>
<h5 id="template-placeholders_8">Template placeholders<a class="headerlink" href="#template-placeholders_8" title="Permanent link">#</a></h5>
<p>Items can be displayed in templates by adding an entry in <code>$data['&lt;placeholder&gt;']</code> array.</p>
<p>List of placeholders:</p>
<ul>
<li><code>plugin_start_zone</code>: before displaying the template content.</li>
<li><code>plugin_end_zone</code>: after displaying the template content.</li>
</ul>
<p>For each tag, the following placeholder can be used:</p>
<ul>
<li><code>tag_plugin</code>: after each tag</li>
</ul>
<h4 id="render_daily">render_daily<a class="headerlink" href="#render_daily" title="Permanent link">#</a></h4>
<p>Triggered when tagcloud is displayed.</p>
<p>Allow to add content at the top and bottom of the page, the bottom of each link and to alter data.</p>
<h5 id="data_9">data<a class="headerlink" href="#data_9" title="Permanent link">#</a></h5>
<p><code>$data</code> is an array containing:</p>
<ul>
<li>All templates data, including links.</li>
<li><a href="#special-data">Special data</a></li>
</ul>
<h5 id="template-placeholders_9">Template placeholders<a class="headerlink" href="#template-placeholders_9" title="Permanent link">#</a></h5>
<p>Items can be displayed in templates by adding an entry in <code>$data['&lt;placeholder&gt;']</code> array.</p>
<p>List of placeholders:</p>
<ul>
<li><code>link_plugin</code>: used at bottom of each link.</li>
</ul>
<p><img alt="link_plugin_example" src="http://i.imgur.com/hzhMfSZ.png" /></p>
<ul>
<li><code>plugin_start_zone</code>: before displaying the template content.</li>
<li><code>plugin_end_zone</code>: after displaying the template content.</li>
</ul>
<h4 id="render_feed">render_feed<a class="headerlink" href="#render_feed" title="Permanent link">#</a></h4>
<p>Triggered when the ATOM or RSS feed is displayed.</p>
<p>Allow to add tags in the feed, either in the header or for each items. Items (links) can also be altered before being rendered.</p>
<h5 id="data_10">data<a class="headerlink" href="#data_10" title="Permanent link">#</a></h5>
<p><code>$data</code> is an array containing:</p>
<ul>
<li>All templates data, including links.</li>
<li><a href="#special-data">Special data</a></li>
</ul>
<h5 id="template-placeholders_10">Template placeholders<a class="headerlink" href="#template-placeholders_10" title="Permanent link">#</a></h5>
<p>Tags can be added in feeds by adding an entry in <code>$data['&lt;placeholder&gt;']</code> array.</p>
<p>List of placeholders:</p>
<ul>
<li><code>feed_plugins_header</code>: used as a header tag in the feed.</li>
</ul>
<p>For each links:</p>
<ul>
<li><code>feed_plugins</code>: additional tag for every link entry.</li>
</ul>
<h4 id="save_link">save_link<a class="headerlink" href="#save_link" title="Permanent link">#</a></h4>
<p>Triggered when a link is save (new link or edit).</p>
<p>Allow to alter the link being saved in the datastore.</p>
<h5 id="data_11">data<a class="headerlink" href="#data_11" title="Permanent link">#</a></h5>
<p><code>$data</code> is an array containing the link being saved:</p>
<ul>
<li>id</li>
<li>title</li>
<li>url</li>
<li>shorturl</li>
<li>description</li>
<li>private</li>
<li>tags</li>
<li>created</li>
<li>updated</li>
</ul>
<p>Also <a href="#special-data">special data</a>.</p>
<h4 id="delete_link">delete_link<a class="headerlink" href="#delete_link" title="Permanent link">#</a></h4>
<p>Triggered when a link is deleted.</p>
<p>Allow to execute any action before the link is actually removed from the datastore</p>
<h5 id="data_12">data<a class="headerlink" href="#data_12" title="Permanent link">#</a></h5>
<p><code>$data</code> is an array containing the link being deleted:</p>
<ul>
<li>id</li>
<li>title</li>
<li>url</li>
<li>shorturl</li>
<li>description</li>
<li>private</li>
<li>tags</li>
<li>created</li>
<li>updated</li>
</ul>
<p>Also <a href="#special-data">special data</a>.</p>
<h4 id="save_plugin_parameters">save_plugin_parameters<a class="headerlink" href="#save_plugin_parameters" title="Permanent link">#</a></h4>
<p>Triggered when the plugin parameters are saved from the plugin administration page.</p>
<p>Plugins can perform an action every times their settings are updated.
For example it is used to update the CSS file of the <code>default_colors</code> plugins.</p>
<h5 id="data_13">data<a class="headerlink" href="#data_13" title="Permanent link">#</a></h5>
<p><code>$data</code> input contains the <code>$_POST</code> array.</p>
<p>So if the plugin has a parameter called <code>MYPLUGIN_PARAMETER</code>,
the array will contain an entry with <code>MYPLUGIN_PARAMETER</code> as a key.</p>
<p>Also <a href="#special-data">special data</a>.</p>
<h4 id="filter_search_entry">filter_search_entry<a class="headerlink" href="#filter_search_entry" title="Permanent link">#</a></h4>
<p>Triggered for <em>every</em> bookmark when Shaarli's BookmarkService method <code>search()</code> is used.
Any custom filter can be added to filter out bookmarks from search results.</p>
<p>The hook <strong>must</strong> return either:
  - <code>true</code> to keep bookmark entry in search result set
  - <code>false</code> to discard bookmark entry in result set</p>
<blockquote>
<p>Note: custom filters are called <em>before</em> default filters are applied.</p>
</blockquote>
<h5 id="parameters_1">Parameters<a class="headerlink" href="#parameters_1" title="Permanent link">#</a></h5>
<ul>
<li><code>Shaarli\Bookmark\Bookmark</code> object: entry to evaluate</li>
<li>$context <code>array</code>: additional information provided depending on what search is currently used,
the user request, etc.</li>
</ul>
<h2 id="guide-for-template-designers">Guide for template designers<a class="headerlink" href="#guide-for-template-designers" title="Permanent link">#</a></h2>
<h3 id="plugin-administration">Plugin administration<a class="headerlink" href="#plugin-administration" title="Permanent link">#</a></h3>
<p>Your theme must include a plugin administration page: <code>pluginsadmin.html</code>.</p>
<blockquote>
<p>Note: repo's template link needs to be added when the PR is merged.</p>
</blockquote>
<p>Use the default one as an example.</p>
<p>Aside from classic RainTPL loops, plugins order is handle by JavaScript. You can just include <code>plugin_admin.js</code>, only if:</p>
<ul>
<li>you're using a table.</li>
<li>you call orderUp() and orderUp() onclick on arrows.</li>
<li>you add data-line and data-order to your rows.</li>
</ul>
<p>Otherwise, you can use your own JS as long as this field is send by the form:</p>
<p><input type="hidden" name="order_{$key}" value="{$counter}"></p>
<h3 id="placeholder-system">Placeholder system<a class="headerlink" href="#placeholder-system" title="Permanent link">#</a></h3>
<p>In order to make plugins work with every custom themes, you need to add variable placeholder in your templates.</p>
<p>It's a RainTPL loop like this:</p>
<pre><code>{loop="$plugin_variable"}
    {$value}
{/loop}
</code></pre>
<p>You should enable <code>demo_plugin</code> for testing purpose, since it uses every placeholder available.</p>
<h3 id="list-of-placeholders">List of placeholders<a class="headerlink" href="#list-of-placeholders" title="Permanent link">#</a></h3>
<p><strong>page.header.html</strong></p>
<p>At the end of the menu:</p>
<pre><code>{loop="$plugins_header.buttons_toolbar"}
    {$value}
{/loop}
</code></pre>
<p>At the end of file, before clearing floating blocks:</p>
<pre><code>{if="!empty($plugin_errors) &amp;&amp; $is_logged_in"}
    &lt;ul class="errors"&gt;
        {loop="plugin_errors"}
            &lt;li&gt;{$value}&lt;/li&gt;
        {/loop}
    &lt;/ul&gt;
{/if}
</code></pre>
<p><strong>includes.html</strong></p>
<p>At the end of the file:</p>
<pre><code class="language-html">{loop=&quot;$plugins_includes.css_files&quot;}
&lt;link type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;{$value}#&quot;/&gt;
{/loop}
</code></pre>
<p><strong>page.footer.html</strong></p>
<p>At the end of your footer notes:</p>
<pre><code class="language-html">{loop=&quot;$plugins_footer.text&quot;}
     {$value}
{/loop}
</code></pre>
<p>At the end of file:</p>
<pre><code class="language-html">{loop=&quot;$plugins_footer.js_files&quot;}
     &lt;script src=&quot;{$value}#&quot;&gt;&lt;/script&gt;
{/loop}
</code></pre>
<p><strong>linklist.html</strong></p>
<p>After search fields:</p>
<pre><code class="language-html">{loop=&quot;$plugins_header.fields_toolbar&quot;}
     {$value}
{/loop}
</code></pre>
<p>Before displaying the link list (after paging):</p>
<pre><code class="language-html">{loop=&quot;$plugin_start_zone&quot;}
     {$value}
{/loop}
</code></pre>
<p>For every links (icons):</p>
<pre><code class="language-html">{loop=&quot;$value.link_plugin&quot;}
    &lt;span&gt;{$value}&lt;/span&gt;
{/loop}
</code></pre>
<p>Before end paging:</p>
<pre><code class="language-html">{loop=&quot;$plugin_end_zone&quot;}
     {$value}
{/loop}
</code></pre>
<p><strong>linklist.paging.html</strong></p>
<p>After the "private only" icon:</p>
<pre><code class="language-html">{loop=&quot;$action_plugin&quot;}
     {$value}
{/loop}
</code></pre>
<p><strong>editlink.html</strong></p>
<p>After tags field:</p>
<pre><code class="language-html">{loop=&quot;$edit_link_plugin&quot;}
     {$value}
{/loop}
</code></pre>
<p><strong>tools.html</strong></p>
<p>After the last tool:</p>
<pre><code class="language-html">{loop=&quot;$tools_plugin&quot;}
     {$value}
{/loop}
</code></pre>
<p><strong>picwall.html</strong></p>
<p>Top:</p>
<pre><code class="language-html">&lt;div id=&quot;plugin_zone_start_picwall&quot; class=&quot;plugin_zone&quot;&gt;
    {loop=&quot;$plugin_start_zone&quot;}
        {$value}
    {/loop}
&lt;/div&gt;
</code></pre>
<p>Bottom:</p>
<pre><code class="language-html">&lt;div id=&quot;plugin_zone_end_picwall&quot; class=&quot;plugin_zone&quot;&gt;
    {loop=&quot;$plugin_end_zone&quot;}
        {$value}
    {/loop}
&lt;/div&gt;
</code></pre>
<p><strong>tagcloud.html</strong></p>
<p>Top:</p>
<pre><code class="language-html">   &lt;div id=&quot;plugin_zone_start_tagcloud&quot; class=&quot;plugin_zone&quot;&gt;
        {loop=&quot;$plugin_start_zone&quot;}
            {$value}
        {/loop}
    &lt;/div&gt;
</code></pre>
<p>Bottom:</p>
<pre><code class="language-html">    &lt;div id=&quot;plugin_zone_end_tagcloud&quot; class=&quot;plugin_zone&quot;&gt;
        {loop=&quot;$plugin_end_zone&quot;}
            {$value}
        {/loop}
    &lt;/div&gt;
</code></pre>
<p><strong>daily.html</strong></p>
<p>Top:</p>
<pre><code class="language-html">&lt;div id=&quot;plugin_zone_start_picwall&quot; class=&quot;plugin_zone&quot;&gt;
     {loop=&quot;$plugin_start_zone&quot;}
         {$value}
     {/loop}
&lt;/div&gt;
</code></pre>
<p>After every link:</p>
<pre><code class="language-html">&lt;div class=&quot;dailyEntryFooter&quot;&gt;
     {loop=&quot;$link.link_plugin&quot;}
          {$value}
     {/loop}
&lt;/div&gt;
</code></pre>
<p>Bottom:</p>
<pre><code class="language-html">&lt;div id=&quot;plugin_zone_end_picwall&quot; class=&quot;plugin_zone&quot;&gt;
    {loop=&quot;$plugin_end_zone&quot;}
        {$value}
    {/loop}
&lt;/div&gt;
</code></pre>
<p><strong>feed.atom.xml</strong> and <strong>feed.rss.xml</strong>:</p>
<p>In headers tags section:</p>
<pre><code class="language-xml">{loop=&quot;$feed_plugins_header&quot;}
  {$value}
{/loop}
</code></pre>
<p>After each entry:</p>
<pre><code class="language-xml">{loop=&quot;$value.feed_plugins&quot;}
  {$value}
{/loop}
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../GnuPG-signature/" class="btn btn-neutral float-left" title="GnuPG signature"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../Translations/" class="btn btn-neutral float-right" title="Translations">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/shaarli/Shaarli" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../GnuPG-signature/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../Translations/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
